

#define CLICKER2

#include <stdlib.h>
#include <stdint.h>
#include <string.h>
#include <stddef.h>
#include <stdbool.h>
#include <stdio.h>
#include <ctype.h>
#include "mcc_generated_files/system.h"
#include "mcc_generated_files/usb/usb.h"
#include "mcc_generated_files/interrupt_manager.h"
#include "mcc_generated_files/i2c3.h"
#include "mcc_generated_files/spi2.h"
#include "mcc_generated_files/tmr3.h"
#include "temp_wrapper.h"
#include "main.h"
#include "gpio_wrapper.h"
#include "usb_wrapper.h"
#include "disp_wrapper.h"
#include "font_wrapper.h"
#include "flash_wrapper.h"
#include "dac_wrapper.h"
#include "batt_wrapper.h"
#include "trigger_wrapper.h"
#include "misc_wrapper.h"
#include "timer_wrapper.h"
#include "cmd_wrapper.h"

#define LINELEN 255
char G_txLine[LINELEN];

int main(void)
{
    SYSTEM_Initialize(); // Generated by MCC
    // FLASH_test();

    TMR3_SetInterruptHandler(&TMR3_callBack);
    TMR3_Start();
    uint16_t pollingLoopCnt = 0;
    while (1)
    {
        pollingLoopCnt = (pollingLoopCnt + 1) % 3000;
        GPIO_handleButtons();
        CMD_handleUSB();
        TEMP_handleTemperature(pollingLoopCnt);
        BATT_handleBatteryVoltage(pollingLoopCnt);
        DISP_handleDisplay();
        USB_flushPrintBuffer();

#ifdef CLICKER2
        GPIO_set(LED1, TRIG_isSignalOn());
        GPIO_set(LED2, DISP_getVcom());
#endif
    }
    return 1;
}


